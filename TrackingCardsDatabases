from time import time # Import time module. This uses UNIX time. 

# This function inserts a new row into the 'picked' table of the database every time a card is picked. Uses SQL statements.
def insert_picked(name):
    insert_sql = "INSERT INTO picked(name, time) VALUES ('{}', {})".format(name, time())
    conn.execute(insert_sql)
    conn.commit()

# This function picks a random card from the database and adds it to 'picked' table. 
def pick_card():
    cards = read_all_cards()
    random_card = cards[randint(0, len(cards) - 1)]
    insert_picked(random_card[0])
    return random_card
    
# This function fetches the card that was last picked (last row added to the picked table when table in descending order).
def read_last_picked():
    result = conn.execute("SELECT * FROM picked ORDER BY time DESC")
    return result.fetchone()

# This function checks that the randomly picked card is not the same as the last picked card
# if it is the same, a new card is picked.
# This ensures two players don't draw the same card.
def pick_card():
    cards = read_all_cards()

    last_picked_card = read_last_picked()

    random_card = cards[randint(0, len(cards) - 1)]

    while random_card[0] == last_picked_card[0]:
        random_card = cards[randint(0, len(cards) - 1)]
# Then adds this card to 'picked' table in the database. 
    insert_picked(random_card[0])
    return random_card
